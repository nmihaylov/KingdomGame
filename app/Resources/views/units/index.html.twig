{% extends 'base.html.twig' %}

{% block main %}
    {% if err %}
        <div class="alert alert-dismissible alert-danger">
            <button type="button" class="close" data-dismiss="alert">&times;</button>
            <strong>{{ err }}</strong>
        </div>
    {% endif %}
    <h3>Units in Kingdom</h3>
    <table class="table table-striped table-hover ">
        <thead>
        <tr>
            <th>Name</th>
            <th>Amount</th>
        </tr>
        </thead>
        <tbody>
        {% for unit in kingdom.units %}
            <tr>
                <td>{{ unit.unit.name }}</td>
                <td>{{ unit.amount }}</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>

    <h3>Barracks - arm more units</h3>
    <table class="table table-striped table-hover">
        <thead>
        <tr>
            <th>Name</th>
            <th>Costs per 1 unit</th>
            <th>Add units</th>
        </tr>
        </thead>
        <tbody>

        {% for unit in units %}
            <tr>
                <td>{{ unit.name }}</td>
                <td>
                    {% for unit_cost in unit.costs %}
                        <b>{{ unit_cost.resource.name }}</b>: {{ unit_cost.amount }}
                    {% endfor %}
                </td>
                <td>
                    {#TODO: make more than just 1 per click#}
                    <a class="btn btn-primary btn-xs" href="{{ path("arm_unit", {id: unit.id}) }}">Arm 5 units</a>
                </td>

            </tr>
        {% endfor %}
        </tbody>
    </table>





    <h3>Barracks - arm more units</h3>
    <table class="table table-striped table-hover">
        <thead>
        <tr>
            <th>Name</th>
            <th>Costs per 1 unit</th>
            <th>Count</th>
            <th>Add units</th>
        </tr>
        </thead>
        {#TEST FROM HERE#}
        <tbody>


        {#{{ form_start(form) }}#}
        {#{{ form_widget(form.unit_count) }}#}
        {#{{ form_widget(form.unit_id) }}#}
        {#<button type="submit">Try this!</button>#}
        {#{{ form_end(form) }}#}

        {% for unit in units %}
            <form name="unit" method="post" action="{{ path("arm_unit", {id: unit.id}) }}">

                <tr>
                    <td>{{ unit.name }}</td>
                    <td>
                        {% for unit_cost in unit.costs %}
                            <b>{{ unit_cost.resource.name }}</b>: {{ unit_cost.amount }}
                        {% endfor %}
                    </td>
                    <td>
                        <input type="hidden" id="unit_unit_id" name="unit[unit_id]" value="{{ unit.id }}">
                        <input type="hidden" id="unit_unit_id" name="unit[kingdom_id] value="{{ kingdom.id }}">
                        <input type="number" id="unit_unit_count" name="unit[amount]" required="required" class="form-control">
                    </td>
                    <td>
                        <button type="submit">Arm units</button>
                    </td>

                </tr>
                {#{{ form_row(form._token) }}#}
            </form>
        {% endfor %}
        </tbody>
    </table>

{% endblock %}